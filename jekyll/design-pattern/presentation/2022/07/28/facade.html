<h2 id="introduction">Introduction</h2>

<p>This pattern</p>

<ul>
  <li>makes my code prettier just like facade increase the taste of my house even thought my house is messy</li>
  <li>belongs to structural patterns, so it structures a specific kind of objects</li>
  <li>deal with <strong>complex</strong> set of objects, which these objects did not follow any particular structure; they should be <strong>messy</strong></li>
</ul>

<div id="facade" class="h-screen justify-center items-center">
  <div id="facade_toggle_erase" class=""></div>
  <div id="facade_image_save" class=""></div>
  <div id="facade_canvas" class="border"></div>
</div>

<script>
  const id = 'facade'
  let binarySearchTree = p5Draw(id)
  let binarySearchTreeP5 = new p5(binarySearchTree, id);
</script>

<h2 id="why">Why?</h2>

<p>We only care about the aspects we care; for example, given a delivery system, user cares <strong>when</strong> the package arrives and the <strong>cost</strong>.</p>

<p>Even thought the process of delivering involves shippings, air transport, …etc and it is truly complicate, we do not care. We should prepare the system to have clean interfaces (facades) for them to acquire the information they want.</p>

<h2 id="how--what">How? &amp; What?</h2>

<p>For example, there are multiple services:</p>

<ul>
  <li>service for transportation: <code class="language-plaintext highlighter-rouge">OceanShippingService</code>, <code class="language-plaintext highlighter-rouge">AirTransportationService</code>, <code class="language-plaintext highlighter-rouge">LandTransportationService</code></li>
  <li>service to evaluate whether this item is deliverable: <code class="language-plaintext highlighter-rouge">Package</code></li>
  <li>service to return possible routes: <code class="language-plaintext highlighter-rouge">Route</code></li>
</ul>

<p>Actually we only care the possible choices of time and cost, so</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="no">WhatWeCare</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="s1">'Taichung'</span><span class="p">,</span> <span class="s1">'Taipei'</span><span class="p">,</span> <span class="s1">'Chihuahua'</span><span class="p">).</span><span class="nf">result</span>
<span class="c1">## example result: (when it arrives, cost)</span>
<span class="p">[</span>
  <span class="p">[</span><span class="s1">'60 mins'</span><span class="p">,</span> <span class="mi">1000</span><span class="p">],</span>
  <span class="p">[</span><span class="s1">'30 mins'</span><span class="p">,</span> <span class="mi">2000</span><span class="p">],</span>
<span class="p">]</span>
</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">WhatWeCare</code> is a facade as follow: (pseudocode)</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">WhatWeCare</span> <span class="c1"># facade</span>
  <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="n">origin</span><span class="p">,</span> <span class="n">destination</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span>
    <span class="vi">@origin</span> <span class="o">=</span> <span class="n">origin</span>
    <span class="vi">@destination</span> <span class="o">=</span> <span class="n">destination</span>
    <span class="vi">@item</span> <span class="o">=</span> <span class="n">item</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">result</span>
    <span class="no">Route</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="vi">@origin</span><span class="p">,</span> <span class="vi">@destination</span><span class="p">).</span><span class="nf">results</span><span class="p">.</span><span class="nf">map</span> <span class="k">do</span> <span class="o">|</span><span class="n">route</span><span class="o">|</span>
      <span class="k">if</span> <span class="n">route</span><span class="p">.</span><span class="nf">is_deliverable?</span>
        <span class="p">[</span>
          <span class="n">when_it_arrives</span><span class="p">(</span><span class="n">route</span><span class="p">),</span>
          <span class="n">cost</span><span class="p">(</span><span class="n">route</span><span class="p">)</span>
        <span class="p">]</span>
      <span class="k">end</span>
    <span class="k">end</span>
  <span class="k">end</span>

  <span class="kp">private</span>
  <span class="k">def</span> <span class="nf">when_it_arrives</span><span class="p">(</span><span class="n">route</span><span class="p">)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">route</span><span class="p">.</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">sub_route</span><span class="o">|</span>
      <span class="k">case</span> <span class="n">sub_route</span><span class="p">.</span><span class="nf">type</span>
      <span class="k">when</span> <span class="s1">'Air'</span>
        <span class="no">AirTransportationService</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="n">sub_route</span><span class="p">).</span><span class="nf">time</span>
      <span class="k">when</span> <span class="s1">'Land'</span>
        <span class="no">LandTransportationService</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="n">sub_route</span><span class="p">).</span><span class="nf">time</span>
      <span class="k">when</span> <span class="s1">'Ocean'</span>
        <span class="no">OceanTransportationService</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="n">sub_route</span><span class="p">).</span><span class="nf">time</span>
      <span class="k">end</span>
    <span class="k">end</span>
    <span class="n">result</span><span class="p">.</span><span class="nf">sum</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">cost</span><span class="p">(</span><span class="n">route</span><span class="p">)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">route</span><span class="p">.</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">sub_route</span><span class="o">|</span>
      <span class="k">case</span> <span class="n">sub_route</span><span class="p">.</span><span class="nf">type</span>
      <span class="k">when</span> <span class="s1">'Air'</span>
        <span class="no">AirTransportationService</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="n">sub_route</span><span class="p">).</span><span class="nf">cost</span>
      <span class="k">when</span> <span class="s1">'Land'</span>
        <span class="no">LandTransportationService</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="n">sub_route</span><span class="p">).</span><span class="nf">cost</span>
      <span class="k">when</span> <span class="s1">'Ocean'</span>
        <span class="no">OceanTransportationService</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="n">sub_route</span><span class="p">).</span><span class="nf">cost</span>
      <span class="k">end</span>
    <span class="k">end</span>
    <span class="n">result</span><span class="p">.</span><span class="nf">sum</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">routes</span><span class="p">(</span><span class="vi">@origin</span><span class="p">,</span> <span class="vi">@destination</span><span class="p">)</span>
    <span class="no">Route</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="vi">@origin</span><span class="p">,</span> <span class="vi">@destination</span><span class="p">)</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div></div>

<p>given the service as follow:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Route</span>
  <span class="c1"># returns all possible routes</span>
  <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="n">origin</span><span class="p">,</span> <span class="n">destination</span><span class="p">)</span>
    <span class="o">...</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">results</span> <span class="c1"># suppose there are two possible routes</span>
    <span class="o">...</span>
    <span class="n">possible_routes</span><span class="p">.</span><span class="nf">map</span> <span class="k">do</span> <span class="o">|</span><span class="n">route</span><span class="o">|</span>
      <span class="k">if</span> <span class="n">is_deliverable?</span><span class="p">(</span><span class="n">route</span><span class="p">)</span>
        <span class="n">route</span>
      <span class="k">end</span>
    <span class="k">end</span>
  <span class="k">end</span>

  <span class="kp">private</span>
  <span class="k">def</span> <span class="nf">possible_routes</span>
    <span class="o">...</span>
    <span class="p">[</span>
      <span class="p">[</span><span class="s1">'Taichung to Taoyuan (Air)'</span><span class="p">,</span> <span class="s1">'Taoyuan to Taipei (Ocean)'</span><span class="p">],</span>
      <span class="p">[</span><span class="s1">'Taichung to Hsinchu (Air)'</span><span class="p">,</span> <span class="s1">'Hsinchu to Banqiao (Ocean)'</span><span class="p">,</span> <span class="s1">'Banqiao to Taipei (Ocean)'</span><span class="p">],</span>
      <span class="o">...</span>
    <span class="p">]</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">is_deliverable?</span><span class="p">(</span><span class="n">route</span><span class="p">)</span>
    <span class="no">Package</span><span class="p">(</span><span class="n">route</span><span class="p">).</span><span class="nf">result</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="k">class</span> <span class="nc">Package</span>
  <span class="c1"># returns whether this package is deliverable in this route</span>
  <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="n">route</span><span class="p">)</span>
    <span class="o">...</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">result</span>
    <span class="o">...</span>
    <span class="kp">true</span> <span class="n">or</span> <span class="kp">false</span> <span class="c1"># whether the item is deliverable in this sub-route</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="k">class</span> <span class="nc">OceanShippingService</span>
  <span class="c1"># returns the estimates of delivery time and cost</span>
  <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="n">route</span><span class="p">)</span>
    <span class="o">...</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">time</span>
    <span class="o">...</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">cost</span>
    <span class="o">...</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="k">class</span> <span class="nc">AirTransportationService</span>
  <span class="c1"># returns the estimates of delivery time and cost</span>
  <span class="k">def</span> <span class="nf">initialize</span>
    <span class="o">...</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">time</span>
    <span class="o">...</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">cost</span>
    <span class="o">...</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="k">class</span> <span class="nc">LandTransportationService</span>
  <span class="c1"># returns the estimates of delivery time and cost</span>
  <span class="k">def</span> <span class="nf">initialize</span>
    <span class="o">...</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">time</span>
    <span class="o">...</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">cost</span>
    <span class="o">...</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div></div>

<h3 id="pros-and-cons">pros and cons</h3>

<h2 id="reference">Reference</h2>

<p><a href="https://refactoring.guru/design-patterns/facade">Facade</a></p>

<p><a href="https://www.youtube.com/watch?v=K4FkHVO5iac">Facade Pattern – Design Patterns (ep 9)</a></p>
